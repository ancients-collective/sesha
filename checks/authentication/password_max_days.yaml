id: password_max_days
name: Password maximum age configured
author: sesha-project
version: "1.0"
description: Verify that /etc/login.defs sets a maximum password age (PASS_MAX_DAYS).
severity: medium
category: authentication
supported_os:
  - linux
tags:
  - cis-benchmark
  - hardening
  - passwords
  - policy

steps:
  - function: file_contains
    args:
      path: /etc/login.defs
      pattern: "^PASS_MAX_DAYS\\s+[0-9]+"

impact: |
  Without a maximum password age, compromised credentials remain valid indefinitely. An attacker who obtains a password hash has unlimited time to crack it, and stolen credentials never expire.
explain: |
  PASS_MAX_DAYS in /etc/login.defs controls how many days a password can be used before the system forces a change. This setting applies to newly created accounts. Existing accounts can be audited with chage -l <username>. Industry standards (CIS, PCI-DSS) typically recommend 90–365 days.
likelihood: possible
break_risk: |
  Setting PASS_MAX_DAYS only affects new accounts by default. Existing users are not forced to change passwords unless you also run chage -M <days> <username>. Users may be locked out if they do not change passwords before expiry — ensure a password change notification is configured.
remediation: |
  Edit /etc/login.defs:
    PASS_MAX_DAYS   365
  For existing accounts, apply individually:
    chage -M 365 <username>
  Verify:
    grep ^PASS_MAX_DAYS /etc/login.defs
    chage -l <username>
references:
  - https://man7.org/linux/man-pages/man5/login.defs.5.html
  - https://www.cisecurity.org/benchmark/distribution_independent_linux
